### Variables
@baseUrl = http://localhost:3000
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY3MzM2YjlmLTc5MWUtNGUzOS1hMTMzLTkxODNmM2YxODdlNiIsImVtYWlsIjoidGVzdDJAZXhhbXBsZS5jb20iLCJpc0FkbWluIjpmYWxzZSwiZmlyc3ROYW1lIjoiSm9obiIsIm5hbWUiOiJEb2UiLCJpYXQiOjE3NjYzMTU1NTQsImV4cCI6MTc2NjMxOTE1NH0.MhFk6ycx0KZ-WtvWEdCDRZNMsKoP5YgvPrkGj2xFUCo
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjA3Y2RmODBmLTU4NDUtNGM2Yy1iZWFlLWFlYjAzZThhMzYwYSIsImVtYWlsIjoidGVzdEBleGFtcGxlLmNvbSIsImlzQWRtaW4iOnRydWUsImZpcnN0TmFtZSI6IkpvaG4iLCJuYW1lIjoiRG9lIiwiaWF0IjoxNzY2MzE1Njk1LCJleHAiOjE3NjYzMTkyOTV9._liZygN8vB9uvrgFvStlgEFo4kgm4mdQdpbYl6aOY0c
@CollectionId = 82ec2043-9f46-431c-a088-9de985f17945
@CardId = 317d9521-c959-4d3b-8333-db31ddcc04bd
@userId = 67336b9f-791e-4e39-a133-9183f3f187e6
### ============================================
### AUTH ROUTES
### ============================================

### Register a new user
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test2@example.com",
  "password": "password123",
  "name": "Doe",
  "firstName": "John"
}

### Login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "password123"
}

### ============================================
### COLLECTION ROUTES (Require Authentication)
### ============================================

### Get user's collections
GET {{baseUrl}}/collections/user/
Authorization: Bearer {{token}}

### Get all public collections
GET {{baseUrl}}/collections/public/PuBliC
Authorization: Bearer {{token}}

### Create a new collection (private)
POST {{baseUrl}}/collections/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "My second Collection",
  "description": "This is a test collection",
  "is_public": false
}

### Create a new collection (public)
POST {{baseUrl}}/collections/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "Public Collection",
  "description": "This is a public collection",
  "is_public": true
}

### Get a specific collection by ID
GET {{baseUrl}}/collections/{{CollectionId}}
Authorization: Bearer {{token}}

### Update a collection
PUT {{baseUrl}}/collections/{{CollectionId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "Updated Collection Title",
  "description": "Updated description",
  "is_public": true
}

### Delete a collection
DELETE {{baseUrl}}/collections/{{CollectionId}}
Authorization: Bearer {{token}}

### ============================================
### CARD ROUTES (Require Authentication)
### ============================================

### create a new card
POST {{baseUrl}}/cards/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "recto": "What is the capital of France?",
  "verso": "Paris",
  "recto_url": "https://a.travel-assets.com/findyours-php/viewfinder/images/res70/474000/474240-Left-Bank-Paris.jpg",
  "verso_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/CAMOU%2C_g%C3%A9n%C3%A9ral_Jacques%2C_Le_Gray%2C_Gallica.jpg/960px-CAMOU%2C_g%C3%A9n%C3%A9ral_Jacques%2C_Le_Gray%2C_Gallica.jpg",
  "collection_id": "{{CollectionId}}"
}

### Get a specific card by ID
GET {{baseUrl}}/cards/{{CardId}}
Authorization: Bearer {{token}}

### Update a card
PUT {{baseUrl}}/cards/{{CardId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "recto": "What is the capital of Germany?",
  "verso": "Berlin",
  "recto_url": "https://example.com/germany.jpg",
  "verso_url": "https://example.com/berlin.jpg"
}

### Get cards from a collection
GET {{baseUrl}}/cards/collection/{{CollectionId}}
Authorization: Bearer {{token}}

### Delete a specific card by ID
DELETE {{baseUrl}}/cards/{{CardId}}
Authorization: Bearer {{token}}

### ============================================
### REVIEW ROUTES (Require Authentication)
### ============================================

### Get cards to review from a collection
GET {{baseUrl}}/reviews/collection/{{CollectionId}}/review
Authorization: Bearer {{token}}

### Review a card (first time)
POST {{baseUrl}}/reviews/{{CardId}}/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 3
}

### Review a card (update existing review)
POST {{baseUrl}}/reviews/{{CardId}}/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 5
}

### Test review with invalid level (should fail)
POST {{baseUrl}}/reviews/{{CardId}}/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 6
}

### Test review with invalid card ID (should fail)
POST {{baseUrl}}/reviews/00000000-0000-0000-0000-000000000000/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 3
}

### Test get cards to review without authentication (should fail)
GET {{baseUrl}}/reviews/collection/{{CollectionId}}/review

### ============================================
### TEST SCENARIOS
### ============================================

### Register another user
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "user2@example.com",
  "password": "password456",
  "name": "Smith",
  "firstName": "Jane"
}

### Test duplicate email registration (should fail with 409)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "password123",
  "name": "Duplicate",
  "firstName": "User"
}

### Test login with wrong password (should fail with 401)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "wrongpassword"
}

### Test accessing collection without token (should fail)
GET {{baseUrl}}/collections/user/

### Test creating collection with duplicate title (should fail with 409)
POST {{baseUrl}}/collections/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "My First Collection",
  "description": "Duplicate title",
  "is_public": false
}

### ============================================
### USER ROUTES (Admin Only)
### ============================================

### Get all users
GET {{baseUrl}}/users/
Content-Type: application/json
Authorization: Bearer {{adminToken}}

### Get a specific user by ID
GET {{baseUrl}}/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{adminToken}}

### Delete a user
DELETE {{baseUrl}}/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{adminToken}}

### Test get all users without admin (should fail with 403)
GET {{baseUrl}}/users/
Content-Type: application/json
Authorization: Bearer {{token}}

### Test get user without admin (should fail with 403)
GET {{baseUrl}}/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

### Test delete user without admin (should fail with 403)
DELETE {{baseUrl}}/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{token}}

### Test get user with invalid ID (should fail with 400)
GET {{baseUrl}}/users/invalid-id
Content-Type: application/json
Authorization: Bearer {{adminToken}}
