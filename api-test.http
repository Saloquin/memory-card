### Variables
@baseUrl = http://localhost:3000
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImRiYmI2MjMxLWZkOWYtNGYyNC1hOWQzLWM2N2E3NTI3N2I1MiIsImVtYWlsIjoidGVzdEBleGFtcGxlLmNvbSIsImlzQWRtaW4iOmZhbHNlLCJmaXJzdE5hbWUiOiJKb2huIiwibmFtZSI6IkRvZSIsImlhdCI6MTc2NjA3MjAzOCwiZXhwIjoxNzY2MDc1NjM4fQ.9hPuV1gbiPetJYlS3RsxqTjl6-3WcETJgBr4EJzz_qs

@CollectionId = e41dc33a-1b87-42f0-9b2e-baded667f34c
@CardId = 9ba5affb-48b5-4919-beec-cad622db1e1c
### ============================================
### AUTH ROUTES
### ============================================

### Register a new user
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "password123",
  "name": "Doe",
  "firstName": "John"
}

### Login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "password123"
}

### ============================================
### COLLECTION ROUTES (Require Authentication)
### ============================================

### Get user's collections
GET {{baseUrl}}/collections/user/
Authorization: Bearer {{token}}

### Get all public collections
GET {{baseUrl}}/collections/public/PuBliC
Authorization: Bearer {{token}}

### Create a new collection (private)
POST {{baseUrl}}/collections/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "My second Collection",
  "description": "This is a test collection",
  "is_public": false
}

### Create a new collection (public)
POST {{baseUrl}}/collections/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "Public Collection",
  "description": "This is a public collection",
  "is_public": true
}

### Get a specific collection by ID
GET {{baseUrl}}/collections/{{CollectionId}}
Authorization: Bearer {{token}}

### Update a collection
PUT {{baseUrl}}/collections/{{CollectionId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "Updated Collection Title",
  "description": "Updated description",
  "is_public": true
}

### Delete a collection
DELETE {{baseUrl}}/collections/{{CollectionId}}
Authorization: Bearer {{token}}

### ============================================
### CARD ROUTES (Require Authentication)
### ============================================

### create a new card
POST {{baseUrl}}/cards/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "recto": "What is the capital of France?",
  "verso": "Paris",
  "recto_url": "https://a.travel-assets.com/findyours-php/viewfinder/images/res70/474000/474240-Left-Bank-Paris.jpg",
  "verso_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/CAMOU%2C_g%C3%A9n%C3%A9ral_Jacques%2C_Le_Gray%2C_Gallica.jpg/960px-CAMOU%2C_g%C3%A9n%C3%A9ral_Jacques%2C_Le_Gray%2C_Gallica.jpg",
  "collection_id": "{{CollectionId}}"
}

### Get a specific card by ID
GET {{baseUrl}}/cards/{{CardId}}
Authorization: Bearer {{token}}

### Update a card
PUT {{baseUrl}}/cards/{{CardId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "recto": "What is the capital of Germany?",
  "verso": "Berlin",
  "recto_url": "https://example.com/germany.jpg",
  "verso_url": "https://example.com/berlin.jpg"
}

### Get cards from a collection
GET {{baseUrl}}/cards/collection/{{CollectionId}}
Authorization: Bearer {{token}}

### Delete a specific card by ID
DELETE {{baseUrl}}/cards/{{CardId}}
Authorization: Bearer {{token}}

### ============================================
### REVIEW ROUTES (Require Authentication)
### ============================================

### Get cards to review from a collection
GET {{baseUrl}}/reviews/collection/{{CollectionId}}/review
Authorization: Bearer {{token}}

### Review a card (first time)
POST {{baseUrl}}/reviews/{{CardId}}/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 3
}

### Review a card (update existing review)
POST {{baseUrl}}/reviews/{{CardId}}/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 5
}

### Test review with invalid level (should fail)
POST {{baseUrl}}/reviews/{{CardId}}/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 6
}

### Test review with invalid card ID (should fail)
POST {{baseUrl}}/reviews/00000000-0000-0000-0000-000000000000/review
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "level_id": 3
}

### Test get cards to review without authentication (should fail)
GET {{baseUrl}}/reviews/collection/{{CollectionId}}/review

### ============================================
### TEST SCENARIOS
### ============================================

### Register another user
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "user2@example.com",
  "password": "password456",
  "name": "Smith",
  "firstName": "Jane"
}

### Test duplicate email registration (should fail with 409)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "password123",
  "name": "Duplicate",
  "firstName": "User"
}

### Test login with wrong password (should fail with 401)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "wrongpassword"
}

### Test accessing collection without token (should fail)
GET {{baseUrl}}/collections/user/

### Test creating collection with duplicate title (should fail with 409)
POST {{baseUrl}}/collections/
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "title": "My First Collection",
  "description": "Duplicate title",
  "is_public": false
}
